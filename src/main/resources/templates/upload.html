<!--&lt;!&ndash;<!DOCTYPE html>&ndash;&gt;-->
<!--&lt;!&ndash;<html lang="en" xmlns:th="http://www.thymeleaf.org">&ndash;&gt;-->
<!--&lt;!&ndash;<head>&ndash;&gt;-->
<!--&lt;!&ndash;    <meta charset="UTF-8">&ndash;&gt;-->
<!--&lt;!&ndash;    <title>Sample page</title>&ndash;&gt;-->
<!--&lt;!&ndash;&lt;!&ndash;    <meta name="_csrf_token" content="${_csrf.token}" />&ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;&lt;!&ndash;    <meta name="_csrf_header" content="${_csrf.headerName}" />&ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;</head>&ndash;&gt;-->
<!--&lt;!&ndash;<body>&ndash;&gt;-->
<!--&lt;!&ndash;<form method="POST" action="/api/upload" enctype="multipart/form-data">&ndash;&gt;-->
<!--&lt;!&ndash;&lt;!&ndash;    <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />&ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;    <button type="button" class="upload-excel">Upload Excel Sheet</button>&ndash;&gt;-->
<!--&lt;!&ndash;    <input type="file" class="file-input" accept=".xlsx, .xls" hidden />&ndash;&gt;-->
<!--&lt;!&ndash;    <div class="file-name"></div>&ndash;&gt;-->
<!--&lt;!&ndash;    <script src="js/excel_upload.js"></script>&ndash;&gt;-->
<!--&lt;!&ndash;</form>&ndash;&gt;-->
<!--&lt;!&ndash;</body>&ndash;&gt;-->
<!--&lt;!&ndash;</html>&ndash;&gt;-->

<!--<!DOCTYPE html>-->
<!--<html lang="en" xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Excel Upload Page</title>-->
<!--    <style>-->
<!--        body {-->
<!--          font-family: Arial, sans-serif;-->
<!--          background: linear-gradient(to right, #6a11cb, #2575fc); /* Gradient background */-->
<!--          margin: 0;-->
<!--          padding: 0;-->
<!--          display: flex;-->
<!--          justify-content: center;-->
<!--          align-items: center;-->
<!--          height: 100vh;-->
<!--        }-->

<!--        .container {-->
<!--          background-color: white;-->
<!--          padding: 30px;-->
<!--          border-radius: 12px;-->
<!--          box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);-->
<!--          max-width: 400px;-->
<!--          width: 100%;-->
<!--        }-->

<!--        h1 {-->
<!--          text-align: center;-->
<!--          color: #5c2dd5; /* Purple heading */-->
<!--          margin-bottom: 20px;-->
<!--        }-->

<!--        .upload-form {-->
<!--          display: flex;-->
<!--          flex-direction: column;-->
<!--          align-items: center;-->
<!--          gap: 15px;-->
<!--        }-->

<!--        input[type="file"] {-->
<!--          width: 100%;-->
<!--          padding: 10px;-->
<!--          margin: 10px 0;-->
<!--          border: 1px solid #ddd;-->
<!--          border-radius: 5px;-->
<!--          box-sizing: border-box;-->
<!--          font-size: 16px;-->
<!--        }-->

<!--        /* Popup styling */-->
<!--        .popup {-->
<!--          display: none;-->
<!--          position: fixed;-->
<!--          top: 0;-->
<!--          left: 0;-->
<!--          width: 100%;-->
<!--          height: 100%;-->
<!--          background-color: rgba(0, 0, 0, 0.7);-->
<!--          justify-content: center;-->
<!--          align-items: center;-->
<!--        }-->

<!--        .popup-content {-->
<!--          background-color: white;-->
<!--          padding: 20px;-->
<!--          border-radius: 12px;-->
<!--          position: relative;-->
<!--          text-align: center;-->
<!--          max-width: 80%;-->
<!--          max-height: 80%;-->
<!--          display: flex;-->
<!--          flex-direction: column;-->
<!--          justify-content: center;-->
<!--        }-->

<!--        /* Gap between close button and image */-->
<!--        .close-btn {-->
<!--          background-color: red;-->
<!--          color: white;-->
<!--          border: none;-->
<!--          padding: 10px 20px;-->
<!--          cursor: pointer;-->
<!--          border-radius: 5px;-->
<!--          margin-bottom: 20px;-->
<!--          align-self: center;-->
<!--        }-->

<!--        .popup img {-->
<!--          display: block;-->
<!--          margin: 0 auto;-->
<!--          max-width: 100%;-->
<!--          max-height: 400px;-->
<!--          width: auto;-->
<!--          height: auto;-->
<!--        }-->

<!--        /* Button styling */-->
<!--        button {-->
<!--          width: 100%;-->
<!--          padding: 12px;-->
<!--          background-color: #7f00ff;-->
<!--          color: white;-->
<!--          border: none;-->
<!--          border-radius: 5px;-->
<!--          cursor: pointer;-->
<!--          font-size: 16px;-->
<!--          transition: background-color 0.3s;-->
<!--        }-->

<!--        button:hover {-->
<!--          background-color: #5c2dd5;-->
<!--        }-->

<!--        /* Centering content */-->
<!--        .upload-form {-->
<!--          display: flex;-->
<!--          flex-direction: column;-->
<!--          justify-content: center;-->
<!--          align-items: center;-->
<!--        }-->

<!--        /* Responsiveness */-->
<!--        @media (max-width: 600px) {-->
<!--          .container {-->
<!--            padding: 20px;-->
<!--            max-width: 90%;-->
<!--          }-->
<!--        }-->

<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<div class="container">-->
<!--    <h1>Upload Excel Sheet</h1>-->
<!--    <form class="upload-form" id="uploadForm" th:action="@{/api/upload}" method="POST" enctype="multipart/form-data">-->
<!--        <input type="file" id="fileInput" name="file" accept=".xlsx, .xls" required>-->
<!--        <a href="/admin" class="button">Submit</a>-->

<!--    </form>-->
<!--</div>-->

<!--&lt;!&ndash; Popup &ndash;&gt;-->
<!--<div class="popup" id="popup">-->
<!--    <div class="popup-content">-->
<!--        <button class="close-btn" id="closePopup">Close</button>-->
<!--        <img th:src="@{/images/demo-excel.png}" alt="Demo Excel Sheet">-->
<!--        <p><b>This is a demo of the Excel sheet format you should upload.</b></p>-->
<!--    </div>-->
<!--</div>-->

<!--<script>-->
<!--    // Show the popup when the page loads-->
<!--    window.onload = function() {-->
<!--      document.getElementById('popup').style.display = 'flex';-->
<!--    };-->

<!--    // Close popup function-->
<!--    document.getElementById('closePopup').onclick = function() {-->
<!--      document.getElementById('popup').style.display = 'none';-->
<!--    };-->

<!--    // Form validation for file input-->
<!--    document.getElementById('uploadForm').addEventListener('submit', function(e) {-->
<!--      const fileInput = document.getElementById('fileInput');-->
<!--      const filePath = fileInput.value;-->
<!--      const allowedExtensions = /(\.xlsx|\.xls)$/i;-->
<!--       window.location.href = '/admin';-->

<!--      if (!allowedExtensions.exec(filePath)) {-->
<!--        alert('Please upload a valid Excel file.');-->
<!--        fileInput.value = ''; // Clear the input-->
<!--        e.preventDefault();-->
<!--      }-->
<!--    });-->

<!--</script>-->
<!--</body>-->
<!--</html>-->




<!--<!DOCTYPE html>-->
<!--<html lang="en" xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Excel Upload Page</title>-->
<!--    <style>-->
<!--        body {-->
<!--          font-family: Arial, sans-serif;-->
<!--          background: linear-gradient(to right, #6a11cb, #2575fc); /* Gradient background */-->
<!--          margin: 0;-->
<!--          padding: 0;-->
<!--          display: flex;-->
<!--          justify-content: center;-->
<!--          align-items: center;-->
<!--          height: 100vh;-->
<!--        }-->

<!--        .container {-->
<!--          background-color: white;-->
<!--          padding: 30px;-->
<!--          border-radius: 12px;-->
<!--          box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);-->
<!--          max-width: 400px;-->
<!--          width: 100%;-->
<!--        }-->

<!--        h1 {-->
<!--          text-align: center;-->
<!--          color: #5c2dd5; /* Purple heading */-->
<!--          margin-bottom: 20px;-->
<!--        }-->

<!--        .upload-form {-->
<!--          display: flex;-->
<!--          flex-direction: column;-->
<!--          align-items: center;-->
<!--          gap: 15px;-->
<!--        }-->

<!--        input[type="file"] {-->
<!--          width: 100%;-->
<!--          padding: 10px;-->
<!--          margin: 10px 0;-->
<!--          border: 1px solid #ddd;-->
<!--          border-radius: 5px;-->
<!--          box-sizing: border-box;-->
<!--          font-size: 16px;-->
<!--        }-->

<!--        /* Popup styling */-->
<!--        .popup {-->
<!--          display: none;-->
<!--          position: fixed;-->
<!--          top: 0;-->
<!--          left: 0;-->
<!--          width: 100%;-->
<!--          height: 100%;-->
<!--          background-color: rgba(0, 0, 0, 0.7);-->
<!--          justify-content: center;-->
<!--          align-items: center;-->
<!--        }-->

<!--        .popup-content {-->
<!--          background-color: white;-->
<!--          padding: 20px;-->
<!--          border-radius: 12px;-->
<!--          position: relative;-->
<!--          text-align: center;-->
<!--          max-width: 80%;-->
<!--          max-height: 80%;-->
<!--          display: flex;-->
<!--          flex-direction: column;-->
<!--          justify-content: center;-->
<!--        }-->

<!--        /* Gap between close button and image */-->
<!--        .close-btn {-->
<!--          background-color: red;-->
<!--          color: white;-->
<!--          border: none;-->
<!--          padding: 10px 20px;-->
<!--          cursor: pointer;-->
<!--          border-radius: 5px;-->
<!--          margin-bottom: 20px;-->
<!--          align-self: center;-->
<!--        }-->

<!--        .popup img {-->
<!--          display: block;-->
<!--          margin: 0 auto;-->
<!--          max-width: 100%;-->
<!--          max-height: 400px;-->
<!--          width: auto;-->
<!--          height: auto;-->
<!--        }-->

<!--        /* Button styling */-->
<!--        button {-->
<!--          width: 100%;-->
<!--          padding: 12px;-->
<!--          background-color: #7f00ff;-->
<!--          color: white;-->
<!--          border: none;-->
<!--          border-radius: 5px;-->
<!--          cursor: pointer;-->
<!--          font-size: 16px;-->
<!--          transition: background-color 0.3s;-->
<!--        }-->

<!--        button:hover {-->
<!--          background-color: #5c2dd5;-->
<!--        }-->

<!--        /* Centering content */-->
<!--        .upload-form {-->
<!--          display: flex;-->
<!--          flex-direction: column;-->
<!--          justify-content: center;-->
<!--          align-items: center;-->
<!--        }-->

<!--        /* Responsiveness */-->
<!--        @media (max-width: 600px) {-->
<!--          .container {-->
<!--            padding: 20px;-->
<!--            max-width: 90%;-->
<!--          }-->
<!--        }-->

<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<div class="container">-->
<!--    <h1>Upload Excel Sheet</h1>-->
<!--    <form class="upload-form" id="uploadForm" th:action="@{/upload}" method="post" enctype="multipart/form-data">-->
<!--        <input type="file" id="fileInput" name="file" accept=".xlsx, .xls" required>-->
<!--        <button type="submit">Submit</button>-->
<!--    </form>-->
<!--</div>-->

<!--&lt;!&ndash; Popup &ndash;&gt;-->
<!--<div class="popup" id="popup">-->
<!--    <div class="popup-content">-->
<!--        <button class="close-btn" id="closePopup">Close</button>-->
<!--        <img th:src="@{/images/demo-excel.png}" alt="Demo Excel Sheet">-->
<!--        <p><b>This is a demo of the Excel sheet format you should upload.</b></p>-->
<!--    </div>-->
<!--</div>-->

<!--<script>-->
<!--    // Show the popup when the page loads-->
<!--    window.onload = function() {-->
<!--      document.getElementById('popup').style.display = 'flex';-->
<!--    };-->

<!--    // Close popup function-->
<!--    document.getElementById('closePopup').onclick = function() {-->
<!--      document.getElementById('popup').style.display = 'none';-->
<!--    };-->

<!--    // Form validation for file input-->
<!--    document.getElementById('uploadForm').addEventListener('submit', function(e) {-->
<!--      const fileInput = document.getElementById('fileInput');-->
<!--      const filePath = fileInput.value;-->
<!--      const allowedExtensions = /(\.xlsx|\.xls)$/i;-->

<!--      if (!allowedExtensions.exec(filePath)) {-->
<!--        alert('Please upload a valid Excel file.');-->
<!--        fileInput.value = ''; // Clear the input-->
<!--        e.preventDefault();-->
<!--      }-->
<!--    });-->
<!--    window.location.href = '/admin';-->
<!--</script>-->
<!--</body>-->
<!--</html>-->




<!--<script>-->
<!--    // Show the popup when the page loads-->
<!--    window.onload = function() {-->
<!--      document.getElementById('popup').style.display = 'flex';-->
<!--    };-->

<!--    // Close popup function-->
<!--    document.getElementById('closePopup').onclick = function() {-->
<!--      document.getElementById('popup').style.display = 'none';-->
<!--    };-->

<!--    // Form validation for file input-->
<!--    document.getElementById('uploadForm').addEventListener('submit', function(e) {-->
<!--      const fileInput = document.getElementById('fileInput');-->
<!--      const filePath = fileInput.value;-->
<!--      const allowedExtensions = /(\.xlsx|\.xls)$/i;-->
<!--       window.location.href = '/admin';-->

<!--      if (!allowedExtensions.exec(filePath)) {-->
<!--        alert('Please upload a valid Excel file.');-->
<!--        fileInput.value = ''; // Clear the input-->
<!--        e.preventDefault();-->
<!--      }-->
<!--    });-->
<!--    const fileInput = document.querySelector(".file-input"),-->
<!--    fileName = document.querySelector(".file-name"),-->
<!--    chooseFile = document.querySelector(".upload-excel");-->

<!--    console.log("File input: ",fileInput); // Ensure fileInput is not null-->
<!--    console.log("File name: ",fileName); // Ensure fileName is not null-->
<!--    console.log("Choose file: ",chooseFile); // Ensure chooseFile is not null-->

<!--    chooseFile.addEventListener("click", () => fileInput.click());-->

<!--    console.log(fileInput); // Ensure fileInput is not null-->
<!--    console.log(fileName); // Ensure fileName is not null-->
<!--    console.log(chooseFile); // Ensure chooseFile is not null-->

<!--    fileInput.addEventListener('change', () => {-->
<!--        let file = fileInput.files[0];-->
<!--        if (!file) return;-->
<!--        fileName.textContent = `Selected file: ${file.name}`;-->

<!--        console.log("Hello");-->
<!--        let formData = new FormData();-->
<!--        formData.append('file', file);-->
<!--        console.log("Hello1");-->

<!--        // Fetch CSRF token and header name from meta tags-->
<!--    //    const csrfToken = document.querySelector('meta[name="_csrf_token"]').getAttribute('content');-->
<!--    //    const csrfHeader = document.querySelector('meta[name="_csrf_header"]').getAttribute('content');-->
<!--    //-->
<!--    //    if (!csrfHeader || !csrfToken) {-->
<!--    //        console.log('CSRF header or token is missing');-->
<!--    //        return;-->
<!--    //    } else {-->
<!--    //        console.log(`CSRF Header: ${csrfHeader}`);-->
<!--    //        console.log(`CSRF Token: ${csrfToken}`);-->
<!--    //    }-->

<!--         // Log FormData contents-->
<!--         for (let [key, value] of formData.entries()) {-->
<!--            console.log(`hello ${key}: ${value}`);-->
<!--         }-->

<!--        fetch('http://localhost:8081/api/upload', {-->
<!--            method: 'POST',-->
<!--            body: formData,-->
<!--    //        headers: {-->
<!--    //            [csrfHeader]: csrfToken // Dynamically set the CSRF header-->
<!--    //        }-->
<!--        })-->

<!--    //    for (let [key, value] of formData.entries()) {-->
<!--    //       console.log(`${key}: ${value}`);-->
<!--    //    }-->
<!--        .then(response => {-->
<!--            console.log(`Response status: ${response.status}`);-->
<!--            if (response.ok) {-->
<!--                // Redirect to the admin page after successful upload-->
<!--                window.location.href = '/admin.html';-->
<!--            } else {-->
<!--                throw new Error('File upload failed');-->
<!--            }-->
<!--        })-->
<!--&lt;!&ndash;        .then(result => {&ndash;&gt;-->
<!--&lt;!&ndash;            console.log("Fetch result:", result);&ndash;&gt;-->
<!--&lt;!&ndash;            alert(result);&ndash;&gt;-->
<!--&lt;!&ndash;            window.location.href = '/admin.html';&ndash;&gt;-->
<!--&lt;!&ndash;        })&ndash;&gt;-->
<!--&lt;!&ndash;        .catch(error => console.error('Error: ', error));&ndash;&gt;-->
<!--        .catch(error => {-->
<!--            console.error('Error:', error);-->
<!--            alert('Failed to upload file: ' + error.message);-->
<!--        });-->
<!--    });-->

<!--</script>-->


<!--<!DOCTYPE html>-->
<!--<html lang="en" xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Excel Upload Page</title>-->
<!--    <style>-->
<!--        body {-->
<!--          font-family: Arial, sans-serif;-->
<!--          background: linear-gradient(to right, #6a11cb, #2575fc); /* Gradient background */-->
<!--          margin: 0;-->
<!--          padding: 0;-->
<!--          display: flex;-->
<!--          justify-content: center;-->
<!--          align-items: center;-->
<!--          height: 100vh;-->
<!--        }-->

<!--        .container {-->
<!--          background-color: white;-->
<!--          padding: 30px;-->
<!--          border-radius: 12px;-->
<!--          box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);-->
<!--          max-width: 400px;-->
<!--          width: 100%;-->
<!--        }-->

<!--        h1 {-->
<!--          text-align: center;-->
<!--          color: #5c2dd5; /* Purple heading */-->
<!--          margin-bottom: 20px;-->
<!--        }-->

<!--        .upload-form {-->
<!--          display: flex;-->
<!--          flex-direction: column;-->
<!--          align-items: center;-->
<!--          gap: 15px;-->
<!--        }-->

<!--        input[type="file"] {-->
<!--          width: 100%;-->
<!--          padding: 10px;-->
<!--          margin: 10px 0;-->
<!--          border: 1px solid #ddd;-->
<!--          border-radius: 5px;-->
<!--          box-sizing: border-box;-->
<!--          font-size: 16px;-->
<!--        }-->

<!--        /* Popup styling */-->
<!--        .popup {-->
<!--          display: none;-->
<!--          position: fixed;-->
<!--          top: 0;-->
<!--          left: 0;-->
<!--          width: 100%;-->
<!--          height: 100%;-->
<!--          background-color: rgba(0, 0, 0, 0.7);-->
<!--          justify-content: center;-->
<!--          align-items: center;-->
<!--        }-->

<!--        .popup-content {-->
<!--          background-color: white;-->
<!--          padding: 20px;-->
<!--          border-radius: 12px;-->
<!--          position: relative;-->
<!--          text-align: center;-->
<!--          max-width: 80%;-->
<!--          max-height: 80%;-->
<!--          display: flex;-->
<!--          flex-direction: column;-->
<!--          justify-content: center;-->
<!--        }-->

<!--        /* Gap between close button and image */-->
<!--        .close-btn {-->
<!--          background-color: red;-->
<!--          color: white;-->
<!--          border: none;-->
<!--          padding: 10px 20px;-->
<!--          cursor: pointer;-->
<!--          border-radius: 5px;-->
<!--          margin-bottom: 20px;-->
<!--          align-self: center;-->
<!--        }-->

<!--        .popup img {-->
<!--          display: block;-->
<!--          margin: 0 auto;-->
<!--          max-width: 100%;-->
<!--          max-height: 400px;-->
<!--          width: auto;-->
<!--          height: auto;-->
<!--        }-->

<!--        /* Button styling */-->
<!--        button {-->
<!--          width: 100%;-->
<!--          padding: 12px;-->
<!--          background-color: #7f00ff;-->
<!--          color: white;-->
<!--          border: none;-->
<!--          border-radius: 5px;-->
<!--          cursor: pointer;-->
<!--          font-size: 16px;-->
<!--          transition: background-color 0.3s;-->
<!--        }-->

<!--        button:hover {-->
<!--          background-color: #5c2dd5;-->
<!--        }-->

<!--        /* Centering content */-->
<!--        .upload-form {-->
<!--          display: flex;-->
<!--          flex-direction: column;-->
<!--          justify-content: center;-->
<!--          align-items: center;-->
<!--        }-->

<!--        /* Responsiveness */-->
<!--        @media (max-width: 600px) {-->
<!--          .container {-->
<!--            padding: 20px;-->
<!--            max-width: 90%;-->
<!--          }-->
<!--        }-->

<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<div class="container">-->
<!--    <h1>Upload Excel Sheet</h1>-->
<!--    <form class="upload-form" id="uploadForm" th:action="@{/api/upload}" method="post" enctype="multipart/form-data">-->
<!--        <input type="file" id="fileInput" name="file" accept=".xlsx, .xls" required>-->
<!--        <button type="submit">Submit</button>-->
<!--    </form>-->
<!--</div>-->

<!--&lt;!&ndash; Popup &ndash;&gt;-->
<!--<div class="popup" id="popup">-->
<!--    <div class="popup-content">-->
<!--        <button class="close-btn" id="closePopup">Close</button>-->
<!--        <img th:src="@{/images/demo-excel.png}" alt="Demo Excel Sheet">-->
<!--        <p><b>This is a demo of the Excel sheet format you should upload.</b></p>-->
<!--    </div>-->
<!--</div>-->
<!--<script>-->
<!--    // Show the popup when the page loads-->
<!--    window.onload = function() {-->
<!--      document.getElementById('popup').style.display = 'flex';-->
<!--    };-->

<!--    // Close popup function-->
<!--    document.getElementById('closePopup').onclick = function() {-->
<!--      document.getElementById('popup').style.display = 'none';-->
<!--    };-->

<!--    // Form validation and file upload-->
<!--    document.getElementById('uploadForm').addEventListener('submit', function(e) {-->
<!--        e.preventDefault(); // Prevent the form from submitting the default way-->

<!--        const fileInput = document.getElementById('fileInput');-->
<!--        const file = fileInput.files[0];-->

<!--        if (!file) {-->
<!--            alert('Please select a file.');-->
<!--            return;-->
<!--        }-->

<!--        const allowedExtensions = /(\.xlsx|\.xls)$/i;-->
<!--        if (!allowedExtensions.exec(fileInput.value)) {-->
<!--            alert('Please upload a valid Excel file.');-->
<!--            fileInput.value = ''; // Clear the input-->
<!--            return;-->
<!--        }-->

<!--        let formData = new FormData();-->
<!--        formData.append('file', file);-->

<!--        fetch('http://localhost:8081/api/upload', {-->
<!--            method: 'POST',-->
<!--            body: formData-->
<!--        })-->
<!--        .then(response => {-->
<!--            if (response.ok) {-->
<!--                // Redirect to admin.html after successful upload-->
<!--                window.location.href = '/admin';-->
<!--            } else {-->
<!--                throw new Error('File upload failed');-->
<!--            }-->
<!--        })-->
<!--        .catch(error => {-->
<!--            console.error('Error:', error);-->
<!--            alert('Failed to upload file: ' + error.message);-->
<!--        });-->
<!--    });-->
<!--</script>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Upload Page</title>
    <style>
        body {
          font-family: Arial, sans-serif;
          background: linear-gradient(to right, #6a11cb, #2575fc);
          margin: 0;
          padding: 0;
          display: flex;
          justify-content: center;
          align-items: center;
          height: 100vh;
        }

        .container {
          background-color: white;
          padding: 30px;
          border-radius: 12px;
          box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
          max-width: 400px;
          width: 100%;
        }

        h1 {
          text-align: center;
          color: #5c2dd5;
          margin-bottom: 20px;
        }

        .upload-form {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 15px;
        }

        input[type="file"] {
          width: 100%;
          padding: 10px;
          margin: 10px 0;
          border: 1px solid #ddd;
          border-radius: 5px;
          box-sizing: border-box;
          font-size: 16px;
        }

        /* Popup styling */
        .popup {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.7);
          justify-content: center;
          align-items: center;
        }

        .popup-content {
          background-color: white;
          padding: 20px;
          border-radius: 12px;
          position: relative;
          text-align: center;
          max-width: 80%;
          max-height: 80%;
          display: flex;
          flex-direction: column;
          justify-content: center;
        }

        .close-btn {
          background-color: red;
          color: white;
          border: none;
          padding: 10px 20px;
          cursor: pointer;
          border-radius: 5px;
          margin-bottom: 20px;
          align-self: center;
        }

        .popup img {
          display: block;
          margin: 0 auto;
          max-width: 100%;
          max-height: 400px;
          width: auto;
          height: auto;
        }

        button {
          width: 100%;
          padding: 12px;
          background-color: #7f00ff;
          color: white;
          border: none;
          border-radius: 5px;
          cursor: pointer;
          font-size: 16px;
          transition: background-color 0.3s;
        }

        button:hover {
          background-color: #5c2dd5;
        }

        .upload-form {
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: center;
        }

        @media (max-width: 600px) {
          .container {
            padding: 20px;
            max-width: 90%;
          }
        }

    </style>
</head>
<body>
<div class="container">
    <h1>Upload Excel Sheet</h1>

    <!-- Button to download template -->
    <a href="/resources/society_name.xlsx" download>
        <button type="button">Download Excel Template</button>
    </a>

    <br>

    <!-- Upload Form -->
    <form class="upload-form" id="uploadForm" th:action="@{/api/upload}" method="post" enctype="multipart/form-data">
        <input type="file" id="fileInput" name="file" accept=".xlsx, .xls" required>
        <button type="submit">Submit</button>
    </form>
</div>


<div class="popup" id="popup">
    <div class="popup-content">
        <button class="close-btn" id="closePopup">Close</button>
        <img th:src="@{/images/demo-excel.png}" alt="Demo Excel Sheet">
        <p><b>This is a demo of the Excel sheet format you should upload.</b></p>
    </div>
</div>

<script>
    // Show the popup when the page loads
    window.onload = function() {
      document.getElementById('popup').style.display = 'flex';
    };

    // Close popup function
    document.getElementById('closePopup').onclick = function() {
      document.getElementById('popup').style.display = 'none';
    };

    // Form validation and file upload
    document.getElementById('uploadForm').addEventListener('submit', function(e) {
        e.preventDefault(); // Prevent the form from submitting the default way

        const fileInput = document.getElementById('fileInput');
        const file = fileInput.files[0];

        if (!file) {
            alert('Please select a file.');
            return;
        }

        const allowedExtensions = /(\.xlsx|\.xls)$/i;
        if (!allowedExtensions.exec(fileInput.value)) {
            alert('Please upload a valid Excel file.');
            fileInput.value = ''; // Clear the input
            return;
        }

        let formData = new FormData();
        formData.append('file', file);

        fetch('http://localhost:5000/api/upload', {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (response.ok) {
                // Redirect to admin.html after successful upload
                window.location.href = '/admin';
            } else {
                throw new Error('File upload failed');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Failed to upload file: ' + error.message);
        });
    });
</script>
</body>
</html>
